<html>
<head>
<style type="text/css">
.gul {
	background-color: yellow;
}
</style>
<script>
//var loc = window.location.toString();
//var cid=loc.substring(12);



function loadXMLDoc(filename)
{
//hjælpefunktion, som indlæser xml til tekstvariabler
if (window.ActiveXObject)
  {
  xhttp = new ActiveXObject("Msxml2.XMLHTTP");
  }
else 
  {
  xhttp = new XMLHttpRequest();
  }
xhttp.open("GET", filename, false);
try {xhttp.responseType = "msxml-document"} catch(err) {} // Helping IE11
xhttp.send("");
return xhttp.responseXML;
}



function displayResult()
{
//evt.preventDefault();

//Lav tekstvariable

//xml-dokument, der skal søges i
xml = loadXMLDoc("1.3.0_Ejerfortegnelsen.xml");

//XSLT-transformationen
xsl = loadXMLDoc("findconcepts.xsl");

//Søgetekst fra HTML-formular nedenfor
sString=document.getElementById('theInput').value;

// Hvis vi er i IE:
if (window.ActiveXObject || xhttp.responseType == "msxml-document")
  {
    //lav en xslt-processor
    var template = new ActiveXObject('Msxml2.XslTemplate');
    //load transformationen
    template.stylesheet = xsl;
    var proc = template.createProcessor();
    //load xml-dokumentet i processoren
    proc.input = xml;
    //tilføj en parameterstreng i transformationen med værdi fra søgefeltet
    proc.addParameter('findIt', sString);
	//transformer!
    proc.transform();
	//put resultatet ind i dokumentet
    document.getElementById("example").innerHTML = proc.output;
  }
// code for Chrome, Firefox, Opera, etc.
else if (typeof XSLTProcessor !== 'undefined')
  {
   //lav en xslt-processor
  xsltProcessor = new XSLTProcessor();
   //load transformationen
  xsltProcessor.importStylesheet(xsl);
  //tilføj en parameterstreng i transformationen med værdi fra søgefeltet
  xsltProcessor.setParameter(null, 'findIt', sString);
  //transformer xml til et tekstfragment
  var resultFragment = xsltProcessor.transformToFragment(xml, document);
  //result = xsltProcessor.transformToFragment(xml, );

  //put resultatet ind i dokumentet
  var unode =  document.getElementById("example");
  
  while (unode.firstChild) {
    unode.removeChild(unode.firstChild);
   }
  unode.appendChild(resultFragment);
  }
  return false;
}
</script>
</head>
<body>
<<! inputformularen - kører displayResult ved Enter>>
<form onsubmit="return displayResult()"><input id="theInput" type="input" >  </form>

<div id="example" />
</body>
</html>
